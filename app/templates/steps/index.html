{% extends "base.html" %}
{% block content %}
<h1>steps 履歴一覧</h1>

<p>
  フィルタ:
  template={{ template if template else "-" }},
  pi_t={{ pi_t if pi_t else "-" }},
  limit={{ limit }}
</p>

<p>
  例:
  <a href="/steps?template=boundary">boundaryのみ</a> |
  <a href="/steps?template=boundary&pi_t=withdraw">boundary + withdraw</a> |
  <a href="/steps?limit=200">limit=200</a>
</p>

<p>表示件数: {{ count }}</p>
<p>取得上限（limit）: {{ limit }}</p>
<p><a href="/boundary">境界テンプレへ</a></p>

<table border="1" cellpadding="6">
  <thead>
    <tr>
      <th>id</th>
      <th>created_at</th>
      <th>template</th>
      <th>pi_t</th>
      <th>o_t summary</th>
      <th>detail</th>
    </tr>
  </thead>
  <tbody>
    {% for s in steps %}
    <tr>
      <td>{{ s["id"] }}</td>
      <td>{{ s["created_at"] }}</td>
      <td>{{ s["template_id"] }}</td>
      <td>{{ s["pi_t"] }}</td>
      <td>
        {% set o = s["o_t"] %}
        threat={{ o.get("threat", "-") }},
        body_alarm={{ o.get("body_alarm", "-") }},
        need_clarity={{ o.get("need_clarity", "-") }},
        energy={{ o.get("energy", "-") }}
      </td>
      <td><a href="/steps/{{ s['id'] }}">開く</a></td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}